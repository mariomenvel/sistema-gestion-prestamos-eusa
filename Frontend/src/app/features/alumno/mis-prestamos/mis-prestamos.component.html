<!-- Mis Préstamos Alumno -->
<div class="mis-prestamos">

  <!-- Título principal -->
  <h1 class="page-title">Mis Préstamos</h1>

  <!-- Barra de búsqueda y filtros -->
<div class="search-filters-container">
  
  <!-- Búsqueda por material -->
  <div class="search-box">
    <input 
      type="text" 
      class="search-input"
      placeholder="Buscar por material..."
      [(ngModel)]="textoBusqueda"
      (input)="aplicarFiltros()"
    >
  </div>

  <!-- Filtros -->
  <div class="filters-box">
    
    <!-- Filtro por tipo -->
    <div class="filter-group">
      <label class="filter-label">Tipo:</label>
      <select 
        class="filter-select"
        [(ngModel)]="filtroTipo"
        (change)="aplicarFiltros()"
      >
        <option value="todos">Todos</option>
        <option value="tipoA">Tipo A</option>
        <option value="tipoB">Tipo B</option>
      </select>
    </div>

    <!-- Filtro desde fecha -->
    <div class="filter-group">
      <label class="filter-label">Desde:</label>
      <input 
        type="date"
        class="filter-date"
        [(ngModel)]="filtroFechaDesde"
        (change)="aplicarFiltros()"
      >
    </div>

    <!-- Filtro hasta fecha -->
    <div class="filter-group">
      <label class="filter-label">Hasta:</label>
      <input 
        type="date"
        class="filter-date"
        [(ngModel)]="filtroFechaHasta"
        (change)="aplicarFiltros()"
      >
    </div>

    <!-- Botón limpiar filtros -->
    <button 
      class="btn-limpiar"
      (click)="limpiarFiltros()"
    >
      Limpiar
    </button>
  </div>
</div>

  <!-- Tabla de préstamos -->
  <div class="table-container">

    <!-- Header de la tabla -->
    <div class="table-header">
      <div class="th th-material">Material</div>
      <div class="th th-tipo">Tipo</div>
      <div class="th th-fecha-prestamo">Fecha Préstamo</div>
      <div class="th th-fecha-devolucion">Fecha Devolución</div>
      <div class="th th-estado">Estado</div>
    </div>

    <!-- Body de la tabla -->
    <div class="table-body">

      <!-- Loading -->
      <div class="empty-state" *ngIf="isLoading">
        Cargando préstamos...
      </div>

      <!-- Error -->
      <div class="empty-state error" *ngIf="errorMessage">
        {{ errorMessage }}
      </div>
      <!-- Sin resultados -->
      <div class="empty-state" *ngIf="!isLoading && !errorMessage && filasFiltradas.length === 0">
        No tienes préstamos ni solicitudes pendientes
      </div>

      <!-- Filas de préstamos -->
      <div class="table-row" *ngFor="let fila of filasFiltradas">

        <!-- Columna: Material -->
        <div class="td td-material">
          {{ fila.material }}
        </div>

        <!-- Columna: Tipo -->
        <div class="td td-tipo">
          {{ fila.tipoSolicitud }}
        </div>

        <!-- Columna: Fecha Préstamo -->
        <div class="td td-fecha-prestamo">
          {{ formatearFecha(fila.fecha) }}
        </div>

        <!-- Columna: Fecha Devolución -->
        <div class="td td-fecha-devolucion">
          {{ fila.fechaFin ? formatearFecha(fila.fechaFin) : '—' }}
        </div>

        <!-- Columna: Estado -->
        <div class="td td-estado">
          <span class="badge" [ngClass]="getEstadoClass(fila.estado)">
            {{ getEstadoTexto(fila.estado) }}
          </span>
        </div>

      </div>

    </div>

  </div>

</div>